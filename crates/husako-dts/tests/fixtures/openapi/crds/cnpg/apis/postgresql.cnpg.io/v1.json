{"components":{"schemas":{"io.cnpg.postgresql.v1.Cluster":{"description":"Cluster is the Schema for the PostgreSQL API.","properties":{"apiVersion":{"description":"APIVersion defines the versioned schema of this representation of an object.","type":"string"},"kind":{"description":"Kind is a string value representing the REST resource this object represents.","type":"string"},"metadata":{"$ref":"#/components/schemas/io.k8s.apimachinery.pkg.apis.meta.v1.ObjectMeta"},"spec":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.ClusterSpec"},"status":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.ClusterStatus"}},"required":["metadata","spec"],"type":"object","x-kubernetes-group-version-kind":[{"group":"postgresql.cnpg.io","kind":"Cluster","version":"v1"}]},"io.cnpg.postgresql.v1.ClusterSpec":{"description":"ClusterSpec defines the desired state of Cluster.","properties":{"instances":{"description":"Number of instances required in the cluster.","format":"int32","minimum":1,"type":"integer"},"imageName":{"description":"Name of the container image, supporting both tags (<image>:<tag>) and digests for deterministic and repeatable deployments.","type":"string"},"postgresqlParameters":{"additionalProperties":{"type":"string"},"description":"Configuration of the PostgreSQL server.","type":"object"},"postgresql":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.PostgresConfiguration","description":"Configuration of the PostgreSQL server."},"bootstrap":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.BootstrapConfiguration","description":"Instructions to bootstrap this cluster."},"storage":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.StorageConfiguration","description":"Configuration of the storage of the instances."},"walStorage":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.StorageConfiguration","description":"Configuration of the WAL storage of the instances."},"backup":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.BackupConfiguration","description":"The configuration to be used for backups."},"resources":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.ResourceRequirementsSpec","description":"Resources requirements of every generated Pod."},"primaryUpdateStrategy":{"description":"Strategy to follow to upgrade the primary server during a rolling update procedure.","enum":["unsupervised","supervised"],"type":"string"},"primaryUpdateMethod":{"description":"Method to follow to upgrade the primary server during a rolling update procedure.","enum":["restart","switchover"],"type":"string"},"minSyncReplicas":{"description":"Minimum number of instances required in synchronous replication with the primary.","format":"int32","type":"integer"},"maxSyncReplicas":{"description":"The target value for the synchronous replication quorum, that can be decreased if the number of ready standbys is lower than this.","format":"int32","type":"integer"},"superuserSecret":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.LocalObjectReference","description":"The secret containing the superuser password."},"enableSuperuserAccess":{"description":"When this option is enabled, the operator will use the SuperuserSecret to update the postgres user password.","type":"boolean"},"monitoring":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.MonitoringConfiguration","description":"The configuration of the monitoring infrastructure of this cluster."},"affinity":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.AffinityConfiguration","description":"Affinity/Antiaffinity group definition."}},"required":["instances","storage"],"type":"object"},"io.cnpg.postgresql.v1.PostgresConfiguration":{"description":"PostgresConfiguration defines the PostgreSQL configuration.","properties":{"parameters":{"additionalProperties":{"type":"string"},"description":"PostgreSQL configuration options.","type":"object"},"pg_hba":{"description":"PostgreSQL Host Based Authentication rules.","items":{"type":"string"},"type":"array"},"shared_preload_libraries":{"description":"Lists of shared preload libraries to add to the default ones.","items":{"type":"string"},"type":"array"}},"type":"object"},"io.cnpg.postgresql.v1.BootstrapConfiguration":{"description":"BootstrapConfiguration contains information about how to create the PostgreSQL cluster.","properties":{"initdb":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.BootstrapInitDB","description":"Bootstrap the cluster via initdb."},"recovery":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.BootstrapRecovery","description":"Bootstrap the cluster from a backup."},"pg_basebackup":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.BootstrapPgBaseBackup","description":"Bootstrap the cluster taking a physical backup of another compatible PostgreSQL instance."}},"type":"object"},"io.cnpg.postgresql.v1.BootstrapInitDB":{"description":"BootstrapInitDB is the configuration of the bootstrap process when initdb is used.","properties":{"database":{"description":"Name of the application database.","type":"string"},"owner":{"description":"Name of the owner of the application database.","type":"string"},"secret":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.LocalObjectReference","description":"Name of the secret containing the initial credentials for the owner of the user database."},"dataChecksums":{"description":"Whether the -k option should be passed to initdb, enabling checksums on data pages.","type":"boolean"},"encoding":{"description":"The value to be passed as option --encoding for initdb.","type":"string"},"localeCollate":{"description":"The value to be passed as option --lc-collate for initdb.","type":"string"},"localeCType":{"description":"The value to be passed as option --lc-ctype for initdb.","type":"string"},"postInitSQL":{"description":"List of SQL queries to be executed as a superuser in the application database right after the cluster has been created.","items":{"type":"string"},"type":"array"}},"type":"object"},"io.cnpg.postgresql.v1.BootstrapRecovery":{"description":"BootstrapRecovery contains the configuration required to restore from an existing cluster using object storage.","properties":{"source":{"description":"The external cluster whose backup we will restore. This is also used as the name of the folder under which the backup objects are stored.","type":"string"},"database":{"description":"Name of the database used by the application. Default to app.","type":"string"},"owner":{"description":"Name of the owner of the database in the instance to be used by applications.","type":"string"},"recoveryTarget":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.RecoveryTarget","description":"By default, the recovery process applies all the available WAL files in the archive. Set this to configure an end point."}},"type":"object"},"io.cnpg.postgresql.v1.RecoveryTarget":{"description":"RecoveryTarget allows to configure the restore to a specific point in time.","properties":{"targetTime":{"description":"The target time as a timestamp in the RFC 3339 standard.","type":"string"},"targetXID":{"description":"The target transaction ID.","type":"string"},"targetName":{"description":"The target name (to be previously created with pg_create_restore_point).","type":"string"},"targetLSN":{"description":"The target LSN (Log Sequence Number).","type":"string"},"targetImmediate":{"description":"End recovery as soon as a consistent state is reached.","type":"boolean"},"exclusive":{"description":"Set the target to be exclusive.","type":"boolean"}},"type":"object"},"io.cnpg.postgresql.v1.BootstrapPgBaseBackup":{"description":"BootstrapPgBaseBackup contains the configuration required to take a physical backup of an existing PostgreSQL cluster.","properties":{"source":{"description":"The name of the server of which we need to take a physical backup.","type":"string"}},"required":["source"],"type":"object"},"io.cnpg.postgresql.v1.StorageConfiguration":{"description":"StorageConfiguration is the configuration of the storage of the PostgreSQL instances.","properties":{"storageClass":{"description":"StorageClass to use for PVCs.","type":"string"},"size":{"description":"Size of the storage. Required if not already specified in the PVC template.","type":"string"},"pvcTemplate":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.PersistentVolumeClaimSpec","description":"Template to be used to generate the Persistent Volume Claim."}},"type":"object"},"io.cnpg.postgresql.v1.PersistentVolumeClaimSpec":{"description":"PersistentVolumeClaimSpec describes a PVC.","properties":{"accessModes":{"description":"AccessModes contains the desired access modes the volume should have.","items":{"type":"string"},"type":"array"},"resources":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.ResourceRequirementsSpec","description":"Resources represents the minimum resources the volume should have."},"storageClassName":{"description":"Name of the StorageClass required by the claim.","type":"string"},"volumeMode":{"description":"Defines what type of volume is required by the claim.","type":"string"}},"type":"object"},"io.cnpg.postgresql.v1.ResourceRequirementsSpec":{"description":"ResourceRequirementsSpec defines the resource requirements for a container.","properties":{"limits":{"additionalProperties":{"type":"string"},"description":"Limits describes the maximum amount of compute resources allowed.","type":"object"},"requests":{"additionalProperties":{"type":"string"},"description":"Requests describes the minimum amount of compute resources required.","type":"object"}},"type":"object"},"io.cnpg.postgresql.v1.BackupConfiguration":{"description":"BackupConfiguration defines how the backup of the cluster are taken.","properties":{"barmanObjectStore":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.BarmanObjectStoreConfiguration","description":"The configuration for the barman-cloud tool suite."},"retentionPolicy":{"description":"RetentionPolicy is the name of the retention policy to be used. Defaults to simple-policy.","type":"string"},"target":{"description":"The policy for the backup target.","enum":["primary","prefer-standby"],"type":"string"}},"type":"object"},"io.cnpg.postgresql.v1.BarmanObjectStoreConfiguration":{"description":"BarmanObjectStoreConfiguration contains the backup configuration using Barman against an S3-compatible object storage.","properties":{"destinationPath":{"description":"The path where to store the backup (i.e. s3://bucket/path/to/folder) this path, with different calculation, is used for new backups and recovery.","type":"string"},"endpointURL":{"description":"Endpoint to be used to upload data to the cloud, overriding the automatic endpoint discovery.","type":"string"},"endpointCA":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.SecretKeySelector","description":"EndpointCA store the CA bundle of the barman endpoint."},"s3Credentials":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.S3Credentials","description":"The credentials to use to upload data to S3."},"wal":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.WalBackupConfiguration","description":"The configuration for the backup of the WAL stream."},"data":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.DataBackupConfiguration","description":"The configuration to be used to backup the data files."}},"required":["destinationPath"],"type":"object"},"io.cnpg.postgresql.v1.S3Credentials":{"description":"S3Credentials is the type for the credentials to be used to upload files to S3.","properties":{"accessKeyId":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.SecretKeySelector","description":"The reference to the access key id."},"secretAccessKey":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.SecretKeySelector","description":"The reference to the secret access key."},"region":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.SecretKeySelector","description":"The reference to the secret containing the region name."},"sessionToken":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.SecretKeySelector","description":"The references to the session key."}},"type":"object"},"io.cnpg.postgresql.v1.SecretKeySelector":{"description":"SecretKeySelector contains enough information to let you locate the key of a Secret.","properties":{"name":{"description":"Name of the referent.","type":"string"},"key":{"description":"The key to select.","type":"string"}},"required":["key","name"],"type":"object"},"io.cnpg.postgresql.v1.WalBackupConfiguration":{"description":"WalBackupConfiguration is the configuration of the backup of the WAL stream.","properties":{"compression":{"description":"Compress a WAL file before sending it to the object store.","enum":["gzip","bzip2","snappy"],"type":"string"},"encryption":{"description":"Whenever to force the encryption of files.","enum":["AES256","aws:kms"],"type":"string"},"maxParallel":{"description":"Number of WAL files to be archived or restored in parallel.","format":"int32","type":"integer"}},"type":"object"},"io.cnpg.postgresql.v1.DataBackupConfiguration":{"description":"DataBackupConfiguration is the configuration of the backup of the data directory.","properties":{"compression":{"description":"Compress a backup file before sending it to the object store.","enum":["gzip","bzip2","snappy"],"type":"string"},"encryption":{"description":"Whenever to force the encryption of files.","enum":["AES256","aws:kms"],"type":"string"},"immediateCheckpoint":{"description":"Control whether the I/O workload for the backup initial checkpoint will be limited.","type":"boolean"},"jobs":{"description":"The number of parallel jobs to be used to upload the backup.","format":"int32","type":"integer"}},"type":"object"},"io.cnpg.postgresql.v1.LocalObjectReference":{"description":"LocalObjectReference contains enough information to locate the referenced Kubernetes resource.","properties":{"name":{"description":"Name of the referent.","type":"string"}},"required":["name"],"type":"object"},"io.cnpg.postgresql.v1.MonitoringConfiguration":{"description":"MonitoringConfiguration is the type for the monitoring configuration.","properties":{"enablePodMonitor":{"description":"Enable or disable the PodMonitor.","type":"boolean"},"customQueriesConfigMap":{"description":"The list of config maps containing the custom queries.","items":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.ConfigMapKeySelector"},"type":"array"},"customQueriesSecret":{"description":"The list of secrets containing the custom queries.","items":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.SecretKeySelector"},"type":"array"}},"type":"object"},"io.cnpg.postgresql.v1.ConfigMapKeySelector":{"description":"ConfigMapKeySelector contains enough information to let you locate the key of a ConfigMap.","properties":{"name":{"description":"Name of the referent.","type":"string"},"key":{"description":"The key to select.","type":"string"}},"required":["key","name"],"type":"object"},"io.cnpg.postgresql.v1.AffinityConfiguration":{"description":"AffinityConfiguration contains the information to generate the affinity rules for the pods.","properties":{"enablePodAntiAffinity":{"description":"Activates anti-affinity for the pods generated by the PostgreSQL cluster.","type":"boolean"},"topologyKey":{"description":"TopologyKey to use for anti-affinity configuration.","type":"string"},"podAntiAffinityType":{"description":"Type of anti-affinity to use.","enum":["preferred","required"],"type":"string"},"nodeSelector":{"additionalProperties":{"type":"string"},"description":"NodeSelector is map of key-value pairs used to define the nodes on which the pods can run.","type":"object"},"tolerations":{"description":"Tolerations is a list of Tolerations that should be set for all the pods.","items":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.Toleration"},"type":"array"}},"type":"object"},"io.cnpg.postgresql.v1.Toleration":{"description":"Toleration defines a toleration for a pod.","properties":{"key":{"description":"Key is the taint key that the toleration applies to.","type":"string"},"operator":{"description":"Operator represents a key's relationship to the value.","enum":["Exists","Equal"],"type":"string"},"value":{"description":"Value is the taint value the toleration matches to.","type":"string"},"effect":{"description":"Effect indicates the taint effect to match.","enum":["NoSchedule","PreferNoSchedule","NoExecute"],"type":"string"},"tolerationSeconds":{"description":"TolerationSeconds represents the period of time the toleration tolerates the taint.","format":"int64","type":"integer"}},"type":"object"},"io.cnpg.postgresql.v1.ClusterStatus":{"description":"ClusterStatus defines the observed state of Cluster.","properties":{"instances":{"description":"Total number of instances in the cluster.","format":"int32","type":"integer"},"readyInstances":{"description":"Total number of ready instances in the cluster.","format":"int32","type":"integer"},"instancesStatus":{"additionalProperties":{"items":{"type":"string"},"type":"array"},"description":"Instances status per pod.","type":"object"},"phase":{"description":"Current phase of the cluster.","type":"string"},"phaseReason":{"description":"Reason for the current phase.","type":"string"},"currentPrimary":{"description":"Current primary instance.","type":"string"},"targetPrimary":{"description":"Target primary instance, used for switchover.","type":"string"},"conditions":{"description":"Conditions is a list of the cluster conditions.","items":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.ClusterCondition"},"type":"array"}},"type":"object"},"io.cnpg.postgresql.v1.ClusterCondition":{"description":"ClusterCondition describes the state of a cluster object at a certain point.","properties":{"type":{"description":"Type of the condition.","type":"string"},"status":{"description":"Status of the condition.","enum":["True","False","Unknown"],"type":"string"},"reason":{"description":"The reason for the condition's last transition.","type":"string"},"message":{"description":"A human-readable message indicating details about the transition.","type":"string"},"lastTransitionTime":{"description":"LastTransitionTime is the last time the condition transitioned from one status to another.","format":"date-time","type":"string"}},"required":["status","type"],"type":"object"},"io.cnpg.postgresql.v1.Backup":{"description":"Backup is the Schema for the backups API.","properties":{"apiVersion":{"description":"APIVersion defines the versioned schema of this representation of an object.","type":"string"},"kind":{"description":"Kind is a string value representing the REST resource this object represents.","type":"string"},"metadata":{"$ref":"#/components/schemas/io.k8s.apimachinery.pkg.apis.meta.v1.ObjectMeta"},"spec":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.BackupSpec"},"status":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.BackupStatus"}},"required":["metadata","spec"],"type":"object","x-kubernetes-group-version-kind":[{"group":"postgresql.cnpg.io","kind":"Backup","version":"v1"}]},"io.cnpg.postgresql.v1.BackupSpec":{"description":"BackupSpec defines the desired state of Backup.","properties":{"cluster":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.LocalObjectReference","description":"The cluster to backup."},"target":{"description":"The policy for the backup target.","enum":["primary","prefer-standby"],"type":"string"},"method":{"description":"The backup method to be used.","enum":["barmanObjectStore","volumeSnapshot"],"type":"string"},"online":{"description":"Whether the backup should be taken while the database is online.","type":"boolean"},"onlineConfiguration":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.OnlineConfiguration","description":"Configuration parameters to control the online backup with pg_backup_start/stop."}},"required":["cluster"],"type":"object"},"io.cnpg.postgresql.v1.OnlineConfiguration":{"description":"OnlineConfiguration contains the configuration for the online backup.","properties":{"waitForArchive":{"description":"If false, the function will return immediately after requesting a fast checkpoint and will not wait for it to complete.","type":"boolean"},"immediateCheckpoint":{"description":"Control whether the I/O workload for the backup initial checkpoint will be limited.","type":"boolean"}},"type":"object"},"io.cnpg.postgresql.v1.BackupStatus":{"description":"BackupStatus defines the observed state of Backup.","properties":{"phase":{"description":"The last backup status.","type":"string"},"startedAt":{"description":"When the backup was started.","format":"date-time","type":"string"},"stoppedAt":{"description":"When the backup was completed.","format":"date-time","type":"string"},"beginWal":{"description":"The starting WAL.","type":"string"},"endWal":{"description":"The ending WAL.","type":"string"},"beginLSN":{"description":"The starting xlog.","type":"string"},"endLSN":{"description":"The ending xlog.","type":"string"},"backupId":{"description":"The ID of the Barman backup.","type":"string"},"destinationPath":{"description":"The path where to store the backup.","type":"string"},"instanceID":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.InstanceID","description":"Information to identify the instance where the backup has been taken from."}},"type":"object"},"io.cnpg.postgresql.v1.InstanceID":{"description":"InstanceID contains the information to identify an instance.","properties":{"podName":{"description":"The pod name.","type":"string"},"containerID":{"description":"The container ID.","type":"string"}},"type":"object"},"io.cnpg.postgresql.v1.ScheduledBackup":{"description":"ScheduledBackup is the Schema for the scheduledbackups API.","properties":{"apiVersion":{"description":"APIVersion defines the versioned schema of this representation of an object.","type":"string"},"kind":{"description":"Kind is a string value representing the REST resource this object represents.","type":"string"},"metadata":{"$ref":"#/components/schemas/io.k8s.apimachinery.pkg.apis.meta.v1.ObjectMeta"},"spec":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.ScheduledBackupSpec"},"status":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.ScheduledBackupStatus"}},"required":["metadata","spec"],"type":"object","x-kubernetes-group-version-kind":[{"group":"postgresql.cnpg.io","kind":"ScheduledBackup","version":"v1"}]},"io.cnpg.postgresql.v1.ScheduledBackupSpec":{"description":"ScheduledBackupSpec defines the desired state of ScheduledBackup.","properties":{"schedule":{"description":"The schedule follows the same format used in Kubernetes CronJobs.","type":"string"},"suspend":{"description":"If this backup is suspended or not.","type":"boolean"},"immediate":{"description":"If the first backup has to be immediately start after creation or not.","type":"boolean"},"cluster":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.LocalObjectReference","description":"The cluster to backup."},"target":{"description":"The policy for the backup target.","enum":["primary","prefer-standby"],"type":"string"},"method":{"description":"The backup method to be used.","enum":["barmanObjectStore","volumeSnapshot"],"type":"string"},"backupOwnerReference":{"description":"Indicates which ownerReference should be put inside the created backup resources.","enum":["none","self","cluster"],"type":"string"},"online":{"description":"Whether the backup should be taken while the database is online.","type":"boolean"},"onlineConfiguration":{"$ref":"#/components/schemas/io.cnpg.postgresql.v1.OnlineConfiguration","description":"Configuration parameters to control the online backup."}},"required":["cluster","schedule"],"type":"object"},"io.cnpg.postgresql.v1.ScheduledBackupStatus":{"description":"ScheduledBackupStatus defines the observed state of ScheduledBackup.","properties":{"lastCheckTime":{"description":"The latest time the schedule.","format":"date-time","type":"string"},"lastScheduleTime":{"description":"Information when was the last time that backup was successfully scheduled.","format":"date-time","type":"string"},"nextScheduleTime":{"description":"Next time we will run a backup.","format":"date-time","type":"string"}},"type":"object"},"io.k8s.apimachinery.pkg.apis.meta.v1.ObjectMeta":{"description":"ObjectMeta is metadata that all persisted resources must have.","properties":{"name":{"description":"Name must be unique within a namespace.","type":"string"},"namespace":{"description":"Namespace defines the space within which each name must be unique.","type":"string"},"labels":{"additionalProperties":{"type":"string"},"description":"Map of string keys and values that can be used to organize and categorize objects.","type":"object"},"annotations":{"additionalProperties":{"type":"string"},"description":"Annotations is an unstructured key value map stored with a resource that may be set by external tools.","type":"object"}},"type":"object"}}}}