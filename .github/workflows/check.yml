# Auto-generated by gaji
# Do not edit manually - Edit workflows/check.ts instead
# Generated at: 2026-02-24T17:11:54Z

jobs:
  e2e:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v5
    - uses: dtolnay/rust-toolchain@stable
    - uses: Swatinem/rust-cache@v2
    - name: Cache husako downloads (Scenario A)
      uses: actions/cache@v4
      with:
        key: ${{ runner.os }}-husako-e2e-${{ hashFiles('test/e2e/husako.toml') }}
        path: test/e2e/.husako/cache
    - name: Install kubeconform
      run: |-
        VER=$(curl -sL "https://api.github.com/repos/yannh/kubeconform/releases/latest" | grep '"tag_name"' | cut -d'"' -f4)
        curl -sL "https://github.com/yannh/kubeconform/releases/download/${VER}/kubeconform-linux-amd64.tar.gz" | tar xz
        chmod +x kubeconform && sudo mv kubeconform /usr/local/bin/kubeconform
    - name: Build husako binary
      run: cargo build --release --bin husako
    - name: E2E tests
      run: bash scripts/e2e.sh
  lint:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v5
    - uses: dtolnay/rust-toolchain@stable
      with:
        components: clippy,rustfmt
    - uses: Swatinem/rust-cache@v2
    - name: Format check
      run: cargo fmt --all --check
    - name: Clippy
      run: cargo clippy --workspace --all-targets --all-features -- -D warnings
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v5
    - uses: dtolnay/rust-toolchain@stable
    - uses: Swatinem/rust-cache@v2
    - name: Run tests
      run: cargo test --workspace --all-features
name: Check
on:
  pull_request:
    branches:
    - master
  push:
    branches:
    - master
